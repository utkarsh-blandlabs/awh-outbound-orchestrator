# ============================================================================
# Production Environment Configuration for EC2
# ============================================================================
# IMPORTANT: Copy this file to .env on your EC2 instance
# Command: cp .env.production .env
# Then update all values marked with YOUR_* placeholders

# ============================================================================
# Server Configuration
# ============================================================================
PORT=3000
NODE_ENV=production
LOG_LEVEL=info

# ============================================================================
# Bland AI Configuration
# ============================================================================
BLAND_API_KEY=org_11f38c964dd9dec077da7f66f88571ada04d5959305927acf7492ac9a476540e6ef4d2790ac01742c8f669
BLAND_BASE_URL=https://api.bland.ai
BLAND_PATHWAY_ID=0258dd7c-e952-43ca-806e-23e1c6c7334b
BLAND_START_NODE_ID=node_1

# ============================================================================
# Phone Numbers
# ============================================================================
# Leave BLAND_FROM empty if number comes from Convoso
BLAND_FROM=
BLAND_TRANSFER_PHONE_NUMBER=+12173866023

# ============================================================================
# Voice Settings
# ============================================================================
BLAND_VOICE_ID=e54a409c-daa9-4ee6-a954-2d81dec3476b
BLAND_MAX_DURATION=30

# ============================================================================
# Call Behavior
# ============================================================================
BLAND_ANSWERING_MACHINE_DETECTION=true
BLAND_WAIT_FOR_GREETING=false
BLAND_BLOCK_INTERRUPTIONS=false
BLAND_RECORD=true

# ============================================================================
# Voicemail Settings
# ============================================================================
BLAND_VOICEMAIL_MESSAGE="{{first_name}} We need to talk about your medical coverage. It's Ashley from the enrollment center. Five. Six. One. Nine. Five. Six. Five. Eight. Five. Eight. Call me now."
BLAND_VOICEMAIL_ACTION="leave_message"
BLAND_ANSWERED_BY_ENABLED=false
BLAND_SENSITIVE_VOICEMAIL_DETECTION=true

# ============================================================================
# Dynamic Templates
# ============================================================================
BLAND_TASK_TEMPLATE="You are Ashley, a patient care coordinator from American Way Health, calling {{first_name}} {{last_name}} about their health insurance inquiry on a recorded line. Your primary goals are to: 1. Confirm you're speaking with the correct patient ({{first_name}} {{last_name}}), 2. Determine if they need an individual or family plan, 3. Collect their age, zip code, and state, 4. Handle objections and transfer to a licensed agent."

BLAND_FIRST_SENTENCE_TEMPLATE="Hi there! I'm responding to the inquiry you submitted for health insurance a minute ago. This is Ashley with American Way Health. Is this {{first_name}} {{last_name}}?"

# ============================================================================
# Webhook Configuration
# ============================================================================
# IMPORTANT: Update this with your EC2 domain or Elastic IP
# With domain + SSL: https://your-domain.com/webhooks/bland-callback
# With Elastic IP + SSL: https://123.456.789.012/webhooks/bland-callback
# Without SSL (testing): http://123.456.789.012/webhooks/bland-callback
BLAND_WEBHOOK_URL=YOUR_DOMAIN_OR_IP_HERE/webhooks/bland-callback

# ============================================================================
# Transcript Polling (DEPRECATED - only used as fallback)
# ============================================================================
BLAND_POLL_INTERVAL=5000
BLAND_POLL_MAX_ATTEMPTS=120

# ============================================================================
# Convoso Configuration
# ============================================================================
CONVOSO_AUTH_TOKEN=2s48q5q07lblt0sarqjmt6nypbq75cwx
CONVOSO_BASE_URL=https://api.convoso.com
CONVOSO_LIST_ID=16529

# ============================================================================
# Retry Configuration
# ============================================================================
RETRY_MAX_ATTEMPTS=3
RETRY_INITIAL_DELAY=1000
RETRY_MAX_DELAY=10000

# ============================================================================
# Rate Limiter Configuration
# ============================================================================
# Enable/disable rate limiting (set to false to disable)
RATE_LIMITER_ENABLED=true
# Global rate limit: Max calls per second (Bland Enterprise allows 5.5)
RATE_LIMITER_MAX_CALLS_PER_SECOND=5
# Per-number limit: Min milliseconds between calls to same number
RATE_LIMITER_SAME_NUMBER_INTERVAL_MS=10000

# ============================================================================
# Cache Retention Configuration
# ============================================================================
# How long to keep completed/failed calls in cache (for admin dashboard & debugging)
CACHE_COMPLETED_RETENTION_MINUTES=90
# How long to keep pending calls before marking as stale (no webhook received)
CACHE_PENDING_MAX_AGE_MINUTES=90
# How often to run cleanup of stale calls
CACHE_CLEANUP_INTERVAL_MINUTES=10

# ============================================================================
# Admin API Configuration
# ============================================================================
# CRITICAL SECURITY: Generate a secure random key for production
# Generate with: openssl rand -base64 32
# This key is required for Retool dashboard access
ADMIN_API_KEY=YOUR_SECURE_RANDOM_KEY_HERE

# ============================================================================
# Instructions for EC2 Setup
# ============================================================================
# 1. SSH to EC2: ssh -i your-key.pem ubuntu@YOUR_EC2_IP
# 2. Navigate to app: cd /var/www/awh-orchestrator
# 3. Copy this file: cp .env.production .env
# 4. Edit .env: nano .env
# 5. Update BLAND_WEBHOOK_URL with your EC2 IP or domain
# 6. Generate secure ADMIN_API_KEY: openssl rand -base64 32
# 7. Save and exit: Ctrl+X, Y, Enter
# 8. Restart app: pm2 restart awh-orchestrator
# ============================================================================
