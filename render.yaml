# Render Blueprint Configuration
# This file configures automatic deployment to Render
# Documentation: https://render.com/docs/blueprint-spec

services:
  - type: web
    name: awh-outbound-orchestrator-staging
    env: node
    region: oregon # Change to your preferred region
    plan: starter # Change to 'standard' or higher for production
    branch: async-orchestrator # Deploy from this branch
    buildCommand: npm install && npm run build
    startCommand: npm start
    healthCheckPath: /health
    envVars:
      - key: NODE_ENV
        value: development
      - key: PORT
        value: 3000
      - key: LOG_LEVEL
        value: debug
      # Sensitive variables - set these in Render Dashboard
      - key: BLAND_API_KEY
        sync: false
      - key: BLAND_PATHWAY_ID
        sync: false
      - key: CONVOSO_AUTH_TOKEN
        sync: false
      - key: ADMIN_API_KEY
        sync: false
      - key: BLAND_WEBHOOK_URL
        sync: false
      # Optional: Auto-set from Render's environment
      - key: BLAND_BASE_URL
        value: https://api.bland.ai
      - key: CONVOSO_BASE_URL
        value: https://api.convoso.com
      - key: RATE_LIMITER_ENABLED
        value: true
      - key: RATE_LIMITER_MAX_CALLS_PER_SECOND
        value: 5
      - key: CACHE_COMPLETED_RETENTION_MINUTES
        value: 90
      - key: CACHE_PENDING_MAX_AGE_MINUTES
        value: 90
      - key: CACHE_CLEANUP_INTERVAL_MINUTES
        value: 10
    autoDeploy: true # Auto-deploy on push to async-orchestrator branch
